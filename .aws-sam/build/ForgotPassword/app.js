"use strict";var y=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var f=Object.prototype.hasOwnProperty;var b=(s,e)=>{for(var a in e)y(s,a,{get:e[a],enumerable:!0})},w=(s,e,a,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of v(e))!f.call(s,t)&&t!==a&&y(s,t,{get:()=>e[t],enumerable:!(n=p(e,t))||n.enumerable});return s};var E=s=>w(y({},"__esModule",{value:!0}),s);var h=(s,e,a)=>new Promise((n,t)=>{var i=r=>{try{o(a.next(r))}catch(m){t(m)}},d=r=>{try{o(a.throw(r))}catch(m){t(m)}},o=r=>r.done?n(r.value):Promise.resolve(r.value).then(i,d);o((a=a.apply(s,e)).next())});var A={};b(A,{lambdaHandler:()=>P});module.exports=E(A);var c=require("@aws-sdk/client-dynamodb"),l=require("@aws-sdk/lib-dynamodb");var u=class{constructor(e){this.body={};this.params={};this.body=e,this.valididity=!1}validate(){if(!this.body)throw this.valididity=!1,Error("Username Required!");if(this.params=JSON.parse(this.body),!this.params.username)throw this.valididity=!1,Error("Username Required!");if(this.params.username.length<10)throw this.valididity=!1,Error("Username length must be min 10 chars long!");if(!this.params.username.includes("@"))throw this.valididity=!1,Error("Username must be an email address!");this.valididity=!0}getParameters(){return this.params}isValid(){return this.valididity}},P=s=>h(void 0,null,function*(){let e="",a=200,n={"Content-Type":"application/json"};try{let i=new u(s.body);if(i.validate(),i.isValid()){let d=i.getParameters(),o=new l.ScanCommand({ProjectionExpression:"auth_id, username",TableName:process.env.TABLE_NAME,FilterExpression:"username = :username AND isActive = :isActive",ExpressionAttributeValues:{":username":d.username,":isActive":!0},ConsistentRead:!0});if((yield l.DynamoDBDocumentClient.from(new c.DynamoDBClient({})).send(o)).Items.length===0)throw Error("Invalid user");a=200,e=`Welcome! ${d.username}`}}catch(i){a=400,e=i.message}return{statusCode:a,body:e,headers:n}});0&&(module.exports={lambdaHandler});
//# sourceMappingURL=app.js.map
